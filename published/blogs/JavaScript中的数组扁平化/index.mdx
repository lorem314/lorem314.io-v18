---
title: JavaScript 中的数组扁平化
tags:
  - JavaScript
  - 数组扁平化
  - 算法
date: 2024-10-27
---

[B站视频讲解](https://www.bilibili.com/video/BV14K1EYDEyN/)

数组扁平化就是将高维数组变为低维数组。

举个几个例子，二维数组 `[[1], [2]]` 经过一次扁平化变为 `[1, 2]`；四维数组 `[1, [2, [3, [4]]]]` 变为 `[1, 2, 3, [4]]`。

下面来说一下函数签名。

我们用 `flat` 函数对数组进行扁平化。函数 `flat` 接收两个参数，第一个参数 `arr` 是一个数组，就是需要被扁平化的数组；第二个参数 `depth` 是一个数值，指示数组需要被扁平化几次，该数值大于 0，可以为 `Infinity`。该函数的返回值，是一个数组，也就是经过了扁平化的数组，维度至少是 1。

下面我们来实现该函数：

```js noLineNumber
function flat(arr, depth = 1) {
  const result = []
  arr.forEach(e => {
    if (Array.isArray(e) && depth > 0) {
      result.push(...flat(e, depth - 1))
    } else {
      result.push(e)
    }
  });
  return result
}
```

前面说，函数返回的是一个数组，那么就先初始化一个数组，最后返回。在这之间，我们用 `forEach` 方法，遍历数组 `arr` 中的每一个元素 `e`，检查其是否为数组。

这里用数组的 `isArray` 静态方法检查元素 `e` 是否为数组。如果是，且 `depth` 的值大于 0，则说明该元素可以被扁平化，也需要被扁平化。

之后，通过递归调用 `flat` 函数，对数组元素 `e` 进行扁平化，传入参数 `e`，同时 `depth` 的值减去 1 后传入，因为此时处于遍历循环中，对于数组 `arr` 中的每个**数组元素**来说，需要少做一次扁平化。

`flat` 函数返回的是数组，我们可以通过**数组解构**的方式，将返回的数组解构，然后通过 `push` 方法，添加到 `result` 数组中。这里的解构操作，就相当于扁平化了一个维度。

如果是其他条件，则将该元素直接添加到 `result` 数组中。

至此，便完成了 `flat` 函数。